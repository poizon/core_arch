/*!
 * froala_editor v2.1.1 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms
 * Copyright 2014-2016 Froala Labs
 */

!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=function(b,c){return void 0===c&&(c="undefined"!=typeof window?require("jquery"):require("jquery")(b)),a(c),c}:a(jQuery)}(function(a){"use strict";a.extend(a.FroalaEditor.DEFAULTS,{dragInline:!0}),a.FroalaEditor.PLUGINS.draggable=function(b){function c(c){return a(c.target).hasClass("fr-draggable")?(a(c.target).addClass("fr-dragging"),b.opts.dragInline?b.$el.attr("contenteditable",!0):b.$el.attr("contenteditable",!1),b.opts.toolbarInline&&b.toolbar.hide(),b.undo.canDo()||b.undo.saveStep(),void c.originalEvent.dataTransfer.setData("text","Froala")):(c.preventDefault(),!1)}function d(a){return!(a&&("HTML"==a.tagName||"BODY"==a.tagName||b.node.isElement(a)))}function e(c){if(c.originalEvent.dataTransfer.dropEffect="move",!b.opts.dragInline){c.preventDefault();var e=b.document.elementFromPoint(c.originalEvent.pageX-b.window.pageXOffset,c.originalEvent.pageY-b.window.pageYOffset);if(!d(e)){for(var f=0,g=e;!d(g)&&g==e&&c.originalEvent.pageY-b.window.pageYOffset-f>0;)f++,g=b.document.elementFromPoint(c.originalEvent.pageX-b.window.pageXOffset,c.originalEvent.pageY-b.window.pageYOffset-f);d(g)&&0!==b.$el.find(g).length||(g=null);for(var h=0,i=e;!d(i)&&i==e&&c.originalEvent.pageY-b.window.pageYOffset+h<a(b.document).height();)h++,i=b.document.elementFromPoint(c.originalEvent.pageX-b.window.pageXOffset,c.originalEvent.pageY-b.window.pageYOffset+h);d(i)&&0!==b.$el.find(i).length||(i=null),e=null==i&&g?g:i&&null==g?i:i&&g?h>f?g:i:null}if(e&&!b.node.isBlock(e)&&(e=b.node.blockParent(e)),e&&["TD","TH","TR","THEAD","TBODY"].indexOf(e.tagName)>=0&&(e=a(e).parents("table").get(0)),e&&["LI"].indexOf(e.tagName)>=0&&(e=a(e).parents("UL, OL").get(0)),e&&!a(e).hasClass("fr-drag-helper")){var j,k=c.originalEvent.pageY;j=k<a(e).offset().top+a(e).outerHeight()/2?!0:!1;var l=b.$el.find(".fr-drag-helper");0===l.length&&(l=a('<div class="fr-drag-helper"></div>')),j&&!l.next().is(e)?(a(e).before(l),l.css("width",a(e).width())):j||l.prev().is(e)||(a(e).after(l),l.css("width",a(e).width()))}}}function f(a){a.originalEvent.dataTransfer.dropEffect="move",b.opts.dragInline||a.preventDefault()}function g(a){b.$el.find(".fr-drag-helper").remove(),b.$el.attr("contenteditable",!0);var c=b.$el.find(".fr-dragging");c.length&&(a.preventDefault(),a.stopPropagation(),c.removeClass("fr-dragging"))}function h(c){for(var d,e,f=0;f<a.FroalaEditor.INSTANCES.length;f++)if(d=a.FroalaEditor.INSTANCES[f].$el.find(".fr-dragging"),d.length){e=a.FroalaEditor.INSTANCES[f];break}if(d.length){c.preventDefault(),c.stopPropagation();var g=b.$el.find(".fr-drag-helper");if(g.length>0)g.attr("class","fr-marker");else{var h=b.markers.insertAtPoint(c.originalEvent);if(h===!1)return!1}b.popups.hideAll(),e==b||b.undo.canDo()||b.undo.saveStep();var i=b.$el.find(".fr-marker");return i.replaceWith(d),d.removeClass("fr-dragging"),b.$el.find(b.html.emptyBlockTagsQuery()).remove(),b.html.wrap(),b.undo.saveStep(),e!=b&&(e.popups.hideAll(),e.$el.find(b.html.emptyBlockTagsQuery()).remove(),e.html.wrap(),e.undo.saveStep(),e.events.trigger("element.dropped")),b.events.trigger("element.dropped",[d]),!1}}function i(){b.opts.enter==a.FroalaEditor.ENTER_BR&&(b.opts.dragInline=!0),b.events.on("dragstart",c,!0),b.events.on("dragover",e,!0),b.events.on("dragenter",f,!0),b.events.on("document.dragend",g,!0),b.events.on("document.drop",g,!0),b.events.on("drop",h,!0),b.events.on("html.get",function(a){return a=a.replace(/<(div)((?:[\w\W]*?))class="([\w\W]*?)fr-drag-helper([\w\W]*?)"((?:[\w\W]*?))>((?:[\w\W]*?))<\/(div)>/g,"")})}return{_init:i}}});